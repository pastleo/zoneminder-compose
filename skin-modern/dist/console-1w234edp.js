import{b as U,c as Y,e as Z}from"/skins/modern/dist/main-xynt3e4r.js";import"/skins/modern/dist/main-3sctwwy9.js";var V=["None","Monitor","Modect","Record","Mocord","Nodect"];function M(){A(),E(),T(),v(),y()}function A(){document.querySelectorAll("[data-select-all]").forEach((q)=>{let J=q.getAttribute("data-select-all");if(!J)return;let j=document.querySelectorAll(`input[name="${J}"]`);q.addEventListener("change",function(){if(this.checked)j.forEach((z)=>{z.checked=!1})}),j.forEach((z)=>{z.addEventListener("change",()=>{let L=Array.from(j).some((K)=>K.checked);q.checked=!L})})})}function E(){U({id:"function-modal",title:"Monitor Function",content:I(),actions:[{label:"Cancel",className:"btn btn-ghost",onClick:()=>{},closeOnClick:!0},{label:"Save",className:"btn btn-primary",type:"submit",onClick:O,closeOnClick:!1}]});let J=document.getElementById("function-form")?.elements.namedItem("newFunction");if(J)J.addEventListener("change",()=>{_(J.value)});document.querySelectorAll(".function-btn").forEach((j)=>{j.addEventListener("click",(z)=>{let L=z.currentTarget;N({mid:L.dataset.mid||"",name:L.dataset.name||"",function:L.dataset.function||"None",enabled:L.dataset.enabled==="1",decoding:L.dataset.decoding==="1"})})})}function I(){let q=V.map((z)=>`<option value="${z}">${z}</option>`).join("");return`
    <form id="function-form" method="post" action="?view=function">
      <input type="hidden" name="__csrf_magic" value="${document.querySelector('input[name="__csrf_magic"]')?.value||""}" />
      <input type="hidden" name="action" value="save" />
      <input type="hidden" name="mid" value="" />

      <div class="mb-4">
        <span id="function-monitor-name" class="font-semibold"></span>
      </div>

      <div class="form-control mb-4">
        <label class="label">
          <span class="label-text">Function</span>
        </label>
        <select name="newFunction" class="select select-bordered w-full">
          ${q}
        </select>
      </div>

      <div id="analysis-row" class="form-control mb-2">
        <label class="label cursor-pointer justify-start gap-3">
          <input type="checkbox" name="newEnabled" value="1" class="checkbox checkbox-primary" />
          <span class="label-text">Analysis Enabled</span>
        </label>
      </div>

      <div id="decoding-row" class="form-control mb-2">
        <label class="label cursor-pointer justify-start gap-3">
          <input type="checkbox" name="newDecodingEnabled" value="1" class="checkbox checkbox-primary" />
          <span class="label-text">Decoding Enabled</span>
        </label>
      </div>
    </form>
  `}function N(q){let J=document.getElementById("function-form");if(!J)return;J.elements.namedItem("mid").value=q.mid,J.elements.namedItem("newFunction").value=q.function,J.elements.namedItem("newEnabled").checked=q.enabled,J.elements.namedItem("newDecodingEnabled").checked=q.decoding;let j=document.getElementById("function-monitor-name");if(j)j.textContent=q.name;_(q.function),Y("function-modal")}function _(q){let J=document.getElementById("analysis-row"),j=document.getElementById("decoding-row");if(J)J.style.display=q==="Monitor"||q==="None"?"none":"";if(j)j.style.display=q==="Record"||q==="Nodect"?"":"none"}function O(q,J){let j=document.getElementById("function-form");if(j)j.submit(),J.close()}function T(){let q=document.getElementById("batchToolbar"),J=document.querySelectorAll(".monitor-checkbox"),j=document.getElementById("monitorActionsForm");if(!q||!J.length||!j)return;let z=document.getElementById("selectedCount"),L=document.getElementById("editBtn"),K=document.getElementById("cloneBtn"),G=document.getElementById("deleteBtn"),$=document.getElementById("cancelSelectBtn");function D(){let W=document.querySelectorAll(".monitor-checkbox:checked").length;if(z)z.textContent=String(W);if(W>0){if(q.classList.remove("hidden"),K)K.classList.toggle("hidden",W!==1)}else q.classList.add("hidden");document.querySelectorAll(".monitor-card").forEach((X)=>{let P=X.querySelector(".monitor-checkbox");X.classList.toggle("ring-2",P?.checked??!1),X.classList.toggle("ring-primary",P?.checked??!1)})}J.forEach((Q)=>{Q.addEventListener("change",D)}),L?.addEventListener("click",()=>{let Q=H();if(Q.length===1)window.location.href=`?view=monitor&mid=${Q[0]}`;else if(Q.length>1)window.location.href=`?view=monitors&${Q.map((W)=>`mids[]=${W}`).join("&")}`}),K?.addEventListener("click",()=>{let Q=H();if(Q.length===1)window.location.href=`?view=monitor&dupId=${Q[0]}`}),G?.addEventListener("click",async()=>{let Q=H().length;if(await Z(`Warning: Deleting ${Q} monitor(s) will also delete all events and database entries associated with them.

Are you sure you wish to delete?`,"Delete Monitors")){let X=j.querySelector('input[name="action"]');if(X)X.value="delete";j.submit()}}),$?.addEventListener("click",()=>{J.forEach((Q)=>{Q.checked=!1}),D()})}function H(){return Array.from(document.querySelectorAll(".monitor-checkbox:checked")).map((q)=>q.value)}function v(){let J=document.querySelector("main")?.dataset.refresh;if(!J||J==="0")return;let j=parseInt(J,10)*1000;if(isNaN(j)||j<=0)return;console.log(`[skin-modern] Auto-refresh enabled: ${J}s`),setInterval(()=>{if(!(document.querySelectorAll(".monitor-checkbox:checked").length>0))window.location.reload()},j)}function y(){let q=document.getElementById("monitorsGrid");if(!q)return;let J=q.querySelectorAll('.monitor-card[draggable="true"]');if(!J.length)return;let j=null;J.forEach((z)=>{let L=z.querySelector(".drag-handle");if(L)L.addEventListener("mousedown",()=>{z.setAttribute("data-drag-allowed","true")}),L.addEventListener("mouseup",()=>{z.removeAttribute("data-drag-allowed")});z.addEventListener("dragstart",(K)=>{if(z.getAttribute("data-drag-allowed")!=="true"){K.preventDefault();return}j=z,z.classList.add("opacity-50","scale-95"),K.dataTransfer.effectAllowed="move",K.dataTransfer.setData("text/plain",z.id)}),z.addEventListener("dragend",()=>{if(j)j.classList.remove("opacity-50","scale-95"),j.removeAttribute("data-drag-allowed");j=null,q.querySelectorAll(".drop-indicator").forEach((K)=>K.remove()),q.querySelectorAll(".drag-over").forEach((K)=>K.classList.remove("drag-over"))}),z.addEventListener("dragover",(K)=>{if(K.preventDefault(),!j||j===z)return;K.dataTransfer.dropEffect="move",z.classList.add("drag-over")}),z.addEventListener("dragleave",()=>{z.classList.remove("drag-over")}),z.addEventListener("drop",(K)=>{if(K.preventDefault(),z.classList.remove("drag-over"),!j||j===z)return;let G=j.nextElementSibling===z,$=z.getBoundingClientRect(),D=$.top+$.height/2,Q=K.clientY<D;if(G)Q=!1;if(Q)q.insertBefore(j,z);else{let W=z.nextElementSibling;if(W)q.insertBefore(j,W);else q.appendChild(j)}R()})})}function R(){let q=document.getElementById("monitorsGrid");if(!q)return;let J=Array.from(q.querySelectorAll(".monitor-card")).map((K)=>K.id).filter((K)=>K),z=document.querySelector('input[name="__csrf_magic"]')?.value||"",L=new URLSearchParams;L.append("action","sort"),L.append("__csrf_magic",z),J.forEach((K)=>L.append("monitor_ids[]",K)),fetch("?request=console",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:L.toString()}).then((K)=>{if(!K.ok)console.error("[skin-modern] Failed to save monitor order:",K.status);else console.log("[skin-modern] Monitor order saved")}).catch((K)=>{console.error("[skin-modern] Failed to save monitor order:",K)})}export{M as init};
